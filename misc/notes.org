
* Actions and Ideas
** COMMENT Stuff that is parked

# Blend the refractive indices of three orientations of a material and
# write the result to =particle-blend.lnk=, usng the wavelength grid
# given in o1.lnk.
#
# : optool -blendonly -c o1.lnk .33 -c o2.lnk .33 -c o3.lnk .33 -l o1.lnk

# - particle-blend.lnk ::
#
#  When =optool= is called with the =-blendonly= switch, the resulting
#  optical properties of the full mix including mantle and porosity are
#  written to this =lnk= file.

# + =-mmf [D_FRACTAL [A_MONO]]=
#
#  Use Modified Mean Field theory (Tazaki & Tanaka 2008) to correct
#  absorption and scattering cross sections for very porous
#  aggregates.  The optional parameters are the fractal dimension and
#  the monomer size, with default values of 3.0 and 0.1 [micron],
#  respectively.


# + =-lunit UNIT= ::
#
#  =optool= uses *microns* as the unit for wavelengths and grain sizes,
#  in line with Michiel Min's original conventions.  With this switch,
#  use =-lunit cm= or =-lunit m= to assume for wavelengths and grain
#  sizes on the command line, in =lnk= files read by the program and
#  output files produced. Note that cross sections are always cm^2/g.

#
# + =-b, -blendonly= :: 
#
#  Only blend the material properties and write the result to a new
#  =lnk= file, =particle_blend.lnk=.

# + =-B= ::
# 
#   Use the old style Blender, for robustness



** TODO propagate rho to fits and write it there?
** TODO Does the angular grid have to be configurable?
Michiels code does assum that teh grid is regular in two places.
1. DMieLay only computes from 0 to pi/2, and then the other half is
   constructed from what we already have
2. Michiel adjusts the forward peak (gust that one grid point) to
   ensure F11 is OK normalised.  The integration done for this assumes
   that the grid is regular (dphi is dropped out of the equation.

So, if we want to refine the grid, we have to do it both at phi=0 and
at phi=pi.  Or, we make a computation with increasing the total number
of grid points, and then let the user program do the interpolation.

Or, if the user asks us to refine at forward, we can just internally
increase nang sufficiently and then interpolate on the grid the user
wants.  Lots of possibilities, all a but complicated.

Another issue is that the 180 is hard-coded in some array dimensions.
So this would have to be fixed as well.  A consequence qould be the
the fits files no longer have fixed array sizes, the the readers of
those files would have to adapt.

For now, I think we leave the angular grid alone - until the need
arizes to change it.

** TODO Fix the FITS issues

** TODO Add an amorphous water ice
** TODO Add more materials
Only ones with good wavelength coverage.
What does Christian Lammert use?
** TODO Make the builtin carbon data smaller, the resolution is too high
We can just use optool -b -l 0.05 3000 100 -c c-z
to do the interpolation....
** SDMB Improve the ingest script
*** TODO Detect if rho and nlam are missing
*** TODO Read Jena/St Petersburg standard files
Careful, cgs lambda
