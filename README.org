* OpTool User Guide
:PROPERTIES:
:EXPORT_OPTIONS: toc:nil num:nil ^:t
:EXPORT_AUTHOR: C. Dominik
:EXPORt_LATEX_CLASS: koma-article
:EXPORt_LATEX_CLASS_OPTIONS: [11pt,a4paper]
:EXPORT_TITLE: OpTool User Guide
:END:


** Introduction

This tool allows to produce complex dust opacities right from the
command line. It is derived from Michiel Min's [[https://dianaproject.wp.st-andrews.ac.uk/data-results-downloads/fortran-package/][OpacityTool]] for the
[[https://dianaproject.wp.st-andrews.ac.uk/][DIANA]] program, and committed to its simplicity. For a more
wide-ranging toolset to produce opacities, check out [[https://github.com/charlenelefevre/SIGMA][SIGMA]], the
/Simple Icy Grain Model for Aggregates/[fn:1], by Lefévre et
al. (2020), also derived from [[https://dianaproject.wp.st-andrews.ac.uk/data-results-downloads/fortran-package/][OpacityTool]], =optool= uses its
effective medium mixing tool set.

[fn:1] SIGMA supports non-powerlaw size distributions, size-dependent
porosities, and adding independent grain types in a single run to
produce combined opacities. It can reproduce and modify many classical
dust models in a computationally efficient way.

*** Capabilities

- fully command line driven, no input files need to be edited
- combining materials through mixing into a complex grain
- built-in materials, but can also be used also external data
- DHS to model shape effects and low-porosity aggregates
- full scattering matrix output in a variety of formats and
  normalizations.

*** Terms of use

The code doing the real work of =optool= was adopted and modified from
the publicly available versions of the [[https://dianaproject.wp.st-andrews.ac.uk/data-results-downloads/fortran-package/][OpacityTool]] and [[https://github.com/charlenelefevre/SIGMA][SIGMA]]. I
focused on the interface, on simplicity, and a clean set of
conventions. If you are using this tool, you should give credit to the
papers describing the methods used to compute the opacities, as well
as to the original laboratory papers that published the refractive
index measurements.

- DHS model for irregular grains:  [[https://ui.adsabs.harvard.edu/abs/2005A%26A...432..909M][Min et al. 2005, A&A, 432, 909]]
- DIANA standard Opacities: [[https://ui.adsabs.harvard.edu/abs/2016A%26A...586A.103W][Woitke, Min et al. 2016]]
- SIGMA: Lefévre, Min et al. 2020, A&A (submitted)
- Third party software: [[https://ui.adsabs.harvard.edu/abs/1981ApOpt..20.3657T][Toon et al. 1981, Applied Optics 20, 3657]]
- References to [[#builtin-materials][refractive index data]] used in your particular
  application.

** Compiling =optool=
On most systems, you can download and compile =optool= with these
simple steps, using the GNU compiler [[https://gcc.gnu.org/wiki/GFortran][=gfortran=]].

: git clone https://github.com/cdominik/optool.git
: cd optool
: make

If you have the [[https://software.intel.com/content/www/us/en/develop/tools/compilers/fortran-compilers.html][Intel fortran compiler]] or the [[https://heasarc.gsfc.nasa.gov/fitsio/][=cfitsio=]] library
installed, these switches can make =optool= take advantage.

: make ifort=true         # compile using the Intel compiler
: make fitsio=true        # add support for writing fits files with cfitsio

** Examples
A simple grain made only of the default pyroxene
: optool -c pyr

Reproduce the DIANA standard dust model, using the pyroxene with 70%
magnesium, and 13% (by mass) carbon, and 25% porosity.
: optool -c pyr-mg70 0.87  -c c-z 0.13  -p 0.25

List the built-in materials
: optool -c ?

Add an ice mantle that is 20% of the core mass
: optool -c pyr-mg70 0.87  -c c-z 0.13  -m ice-w 0.2 -p 0.25

Like the previous example, but use ice refractive index data from a
separate file.

: optool -c pyr-mg70 0.87  -c c-z 0.13  -m ~/lnk/ice_hudgins_2.dat 0.2  -p 0.25

Pure ice grains in a narrow size distribution from 1 to 3 microns,
with 15 sample sizes following an $f(a)\propto a^{-2.5}$ powerlaw size
distribution. Also, restrict the wavelength range to 10-100\mu{}m.

: optool -c ice-w 1.0 -a 1 3 2.5 15 -l 10 100

Represent the default dust model (DIANA) in 42 grain sizes, and
produce input files with full scattering matrix for RADMC-3D.

: optool -na 42 -d -s -radmc


** Command line options

+ =-h, -help= :: Show a compact help message about command line
  options.

*** Grain composition and geometry
  
+ =-c ?= :: List available built-in materials (the keys for the *-c* and
  *-m* options).

+ =-c KEY-or-FILE [Mfrac]= ::

  Specify a material to include into the grain.  =KEYorFILE= can be the
  [[#builtin-materials][key for a builtin material]], or the path to the correct
  =lnk= file. =Mfrac= is the /mass/ fraction of the material. You can
  give up to 10 *-c* switches to add the different contributions.  All
  materials will be mixed together using the Bruggeman rule, and
  vacuum can be included through the porosity.

+ =-m KEY-or-FILE [Mfrac]= ::

  Like *-c*, but use this material as a mantle material that will be
  mixed in using the Maxwell-Garnett rule instead of the Bruggeman
  rule.  Only one *-m* switch is allowed, and it needs to come after
  all *-c* specifications.
  
+ =-p POROSITY [P_MANTLE]= ::

  Porosity, the /volume/ fraction of vacuum, a number smaller than 1.
  The default is 0.  A single value will apply to both core and
  mantle, but a second value will be specific for the mantle (and may
  be 0).
  
+ =-fmax VHMAX= ::

  Maximum /volume/ fraction of the inner hole for the DHS approach.
  The default is 0.8.  Zero means to use solid spheres, i.e. perfectly
  regular grains.


*** Grain size distribution
+ =-a AMIN AMAX [NA [APOW]]= ::

  Specify minimum and maximum grain radius, and optionally the
  number of size bins and the size distribution powerlaw.  You can
  also use the options *-amin*, *-amax*, *-na*, *-apow*, to set
  individual values.  The defaults are 0.05 \mu{}m, 3000 \mu{}m, 100,
  and 3.5, respectively.

*** Wavelength grid

+ =-l LMIN LMAX [NLAM]= ::

  Minimum and maximum wavelength and optionally the number of
  wavelengths points for the construction of the wavelength grid.  The
  default values are 0.05 \mu{}m, 10000 \mu{}m, and 300, respectively.
  Use the options *-lmin*, *-lmax*, and *-nlam* (or *-nl*) to set
  individual values.

+ =-l FILE= ::

  Read the wavelength grid from the first column of FILE.  The first
  number in the file must be the number of grid points. So this could
  be an [[#lnk-files][=lnk=]] file.

*** Controlling the output

The standard output is the file =dustkappa.dat=, with the opacities
and the asymmetry parameter /g/. The following options lead to
extended output.  See the section [[#output-files][Output files]] for details on the
files that can be produced.

+ =-s= , =-scat= ::

  Include the full scattering matrix in the output. Without this
  switch, the output is limited to just \kappa_abs, \kappa_sca, and
  /g/.

+ =-t [TMIN [TMAX [NT]]]= ::
  
  Compute mean opacities per g of dust mass, \kappa_Planck and
  \kappa_Rosseland, in the given temperature interval, in =nt= steps,
  and write them to the file =dustkapmean.dat=. The parameters
  default to 10K, 10000K, and 200.

+ =-d [NSUB]= ::

  Divide the computation up into =NA= parts to produce a file for each
  grain size.  Each size will actually be an average over a small
  range of NSUB grains around the real size, to smear out resonances.
  The default for NSUB is 5.

+ =-fits= ::

  Write =dustkappa.fits= with the absorption cross sections and
  scattering matrix elements, instead of ASCII output.  With the =-d=
  switch, =NA= such files will be written, one for each grain size.

+ =-radmc [LABEL]= , =-radmc3d [LABEL]=  ::

  The structure of the ASCII output of =optool= is already compatible
  with RADMC-3D. However, RADMC-3D uses a different normalization for
  the scattering matrix, see [[#normalization][the appendix]] for more information.  With
  this switch, the extension of the files will be changed to =.inp=,
  the normalization will be modified, and if you specify LABEL, it
  will be used in the file name(s).


** Material properties
=optool= needs refractive index data to work.  For your convenience, a
useful list of materials is compiled into =optool=, but you can also
find and use your own data.  No matter where the data is from, you
should /always/ cite the original laboratory papers.

*** Built-in materials
:PROPERTIES:
:CUSTOM_ID: builtin-materials
:END:

To access one of the built-in materials, specify the corresponding key
string like =pyr-mg70= instead of the path to an =lnk= file. In each
material class I have selected a useful default, accessible with an
even simpler generic key.  The built-in list might be enough for
opacity computation.  If your goal is detailed mineralogical fits, you
will have to use specialized refractive index data.

#+ATTR_LATEX: :font \small\sf :align llllrrlHH
| *-c Key* | *-c Key*   | *Material*              | *State*       |     \rho | \lambda_min | *Reference*    | *Comment*    | *File*                      |
| generic  | full key   |                         |               | [g/cm^3] |    [\mu{}m] |                |              |                             |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
|          | pyr-mg100  | MgSiO_3                 | amorphous     |     2.71 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] |              | [[file:lnk_data/pyr-mg100-Dorschner1995.lnk][pyr-mg100-Dorschner1995.lnk]] |
|          | pyr-mg95   | Mg_{0.95}Fe_{0.05}SiO_3 | amorphous     |     2.74 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] |              | [[file:lnk_data/pyr-mg95-Dorschner1995.lnk][pyr-mg95-Dorschner1995.lnk]]  |
|          | pyr-mg80   | Mg_{0.8}Fe_{0.2}SiO_3   | amorphous     |      2.9 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] | \rho interp. | [[file:lnk_data/pyr-mg80-Dorschner1995.lnk][pyr-mg80-Dorschner1995.lnk]]  |
| pyr      | pyr-mg70   | Mg_{0.7}Fe_{0.3}SiO_3   | amorphous     |     3.01 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] |              | [[file:lnk_data/pyr-mg70-Dorschner1995.lnk][pyr-mg70-Dorschner1995.lnk]]  |
|          | pyr-mg60   | Mg_{0.6}Fe_{0.4}SiO_3   | amorphous     |      3.1 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] | \rho interp. | [[file:lnk_data/pyr-mg60-Dorschner1995.lnk][pyr-mg60-Dorschner1995.lnk]]  |
|          | pyr-mg50   | Mg_{0.5}Fe_{0.5}SiO_3   | amorphous     |      3.2 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] |              | [[file:lnk_data/pyr-mg50-Dorschner1995.lnk][pyr-mg50-Dorschner1995.lnk]]  |
|          | pyr-mg40   | Mg_{0.4}Fe_{0.6}SiO_3   | amorphous     |      3.3 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] | \rho interp. | [[file:lnk_data/pyr-mg40-Dorschner1995.lnk][pyr-mg40-Dorschner1995.lnk]]  |
| ens      | pyr-c-mg96 | Mg_{0.96}Fe_{0.04}SiO3  | crystalline   |      2.8 |       *2.0* | [[https://ui.adsabs.harvard.edu/abs/1998A%26A...339..904J][Jäger+1998]]     |              | [[file:lnk_data/pyr-c-mg96-Jäger1998.lnk][pyr-c-mg96-Jäger1998.lnk]]    |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
| ol       | ol-mg50    | MgFeSiO_4               | amorphous     |     3.71 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] |              | [[file:lnk_data/ol-mg50-Dorschner1995.lnk][ol-mg50-Dorschner1995.lnk]]   |
|          | ol-mg40    | Mg_0.8 Fe_1.2 SiO_4     | amorphous     |     3.71 |         0.2 | [[https://ui.adsabs.harvard.edu/abs/1995A%26A...300..503D/abstract][Dorschner+1995]] | \rho ?       | [[file:lnk_data/ol-mg40-Dorschner1995.lnk][ol-mg40-Dorschner1995.lnk]]   |
| for      | ol-c-mg100 | Mg_2 SiO_4              | crystalline   |     3.33 |       *3.0* | [[https://ui.adsabs.harvard.edu/abs/1974PhDT.......274S][Steyer+1974]]    | switch out?  | [[file:lnk_data/ol-c-mg100-Steyer1974.lnk][ol-c-mg100-Steyer1974.lnk]]   |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
| c        | c-z        | C                       | amorphous?    |      1.8 |        0.05 | [[https://ui.adsabs.harvard.edu/abs/1996MNRAS.282.1321Z/abstract][Zubko+1996]]     |              | [[file:lnk_data/c-z-Zubko1996.lnk][c-z-Zubko1996.lnk]]           |
|          | c-p        | C                       | amorphous     |      1.8 |        0.11 | [[https://ui.adsabs.harvard.edu/abs/1993A%26A...279..577P/abstract][Preibisch+1993]] |              | [[file:lnk_data/c-p-Preibisch1993.lnk][c-p-Preibisch1993.lnk]]       |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
| ice      | ice-w      | Water ice               | crystalline   |     0.92 |        0.04 | [[https://ui.adsabs.harvard.edu/abs/2008JGRD..11314220W/abstract][Warren+2008]]    |              | [[file:lnk_data/ice-w-Warren2008.lnk][ice-w-Warren2008.lnk]]        |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
| iron     | fe-c       | Fe                      | metallic iron |     7.87 |         0.1 | [[https://ui.adsabs.harvard.edu/abs/1996A%26A...311..291H][Henning+1996]]   |              | [[file:lnk_data/fe-c-Henning1996.lnk][fe-c-Henning1996.lnk]]        |
|----------+------------+-------------------------+---------------+----------+-------------+----------------+--------------+-----------------------------|
| cor      | cor-c      | Al_{2}O_3               | crystalline   |      4.0 |         0.5 | [[https://ui.adsabs.harvard.edu/abs/1995Icar..114..203K][Koike+1995]]     |              | [[file:lnk_data/cor-c-Koike1995.lnk][cor-c-Koike1995.lnk]]         |


**** COMMENT Options for more materials
These are under consideration.  One problem is the limited wavelengths
range....

One could make an argument for a whole mineralogy section, of
course.....  But there would be so many hard-to-remember keys....

For now, the cut we are making is good.
|     | ol-c-mg100-T295 | Mg_2 SiO_4      | crystalline  | 3.37 | *5.0* | [[https://ui.adsabs.harvard.edu/abs/2006MNRAS.370.1599S][Suto+2006]]     | switch out?     | ????                      |
| ??? | ice             | Water ice       | amorphous    |      |       |               |                 |                           |
| fes | fes             | FeS             | crystalline? | 4.83 | *10*  | [[https://ui.adsabs.harvard.edu/abs/1994ApJ...423L..71B][Begemann+1994]] | \rho guessed    | fes-Begemann1994.lnk      |
|     | fes-mg10        | Fe_0.9 Mg_0.1 S | crystalline? | 4.83 | *10*  | [[https://ui.adsabs.harvard.edu/abs/1994ApJ...423L..71B][Begemann+1994]] | \rho set to FeS | fes-mg10-Begemann1994.lnk |
|     | fes-mg50        | Fe_0.5 Mg_0.5 S | crystalline? | 4.83 | *10*  | [[https://ui.adsabs.harvard.edu/abs/1994ApJ...423L..71B][Begemann+1994]] | \rho set to FeS | fes-mg50-Begemann1994.lnk |
|-----+-----------------+-----------------+--------------+------+-------+---------------+-----------------+---------------------------|





*** External refractory index files (=lnk= files)
:PROPERTIES:
:CUSTOM_ID: lnk-files
:END:

=optool= can also use external refractive index data in files with the
following format:
- The file may start with several comment lines (lines starting with
  =!=, =#=, or =*=).
- The first non-comment line contains two numbers, the number of
  wavelengths $N_\lambda$ and the specific weight \rho of the material
  in g/cm^3
- Starting in the next line, each line has the wavelength in
  micrometer, and then the real and imaginary values of the refractive
  index, $n$ and $k$.

You can use any of the refractory index files provided by Charléne
Lefévre's SIGMA package out of the box, or find other files, for
example by using the [[https://www.astro.uni-jena.de/Laboratory/Database/databases.html][Jena database]]. Don't forget to add the line with
number of grid points and specific density!  If for some reason it is
not convenient to add that line to the file, =optool= will count the
lines for you and you can specify the density (3.42 in this example)
after the mass fraction, like this:
: optool -c path/to/file.lnk 0.7 3.42



** Output files
:PROPERTIES:
:CUSTOM_ID: output-files
:END:

- dustkappa.dat ::

  This is an ASCII file containing the basic opacity results. It
  starts with a comment section describing the dust model, followed by
  the format number (3, currently), followed by the number of
  wavelengths in the grid, both on lines by themselves.  Then follows
  a block with these columns:

  1. wavelength \lambda [micron]
  2. mass absorption cross section \kappa_abs [cm^2/g]
  3. mass scattering cross section \kappa_sca [cm^2/g]
  4. asymmetry parameter /g/

- dustkapscatmat.dat ::

  ASCII file with cross sections and full scattering matrix.  The
  comment section at the stars of the file explains the structure. See
  [[#normalization][the appendix]] for information about the normalization of the
  scattering matrix.  And see the =-radmc= switch which will modify
  the output to make sure it can be used as an input file for
  [[http://www.ita.uni-heidelberg.de/~dullemond/software/radmc-3d/][RADMC-3D]].

- dustkappa.fits ::

  The fits-file (ending in ’.fits’) is written instead of the ASCII
  output when using the =-fits= switch. It has two HDU blocks. The first
  block contains the cross sections per unit mass. This is a N_\lambda
  \times 5 matrix with these columns:

  1. wavelengths in [\mu{}m]
  2. mass extinction cross section \kappa_ext in [cm^2/g]
  3. mass absorption cross section \kappa_abs in [cm^2/g]
  4. mass scattering cross section \kappa_sca in [cm^2/g]
  5. asymmetry factor /g/

  The second HDU block contains the scattering matrix elements. This
  is a N_\lambda \times 6 \times 180 matrix. These are the 6
  elements of the scattering matrix for 180 equidistant scattering
  angles from forward scattering (element 0) to backward scattering
  (element 179) for each wavelength value. The 6 elements stored are
  F_11, F_12, F_22, F_33, F_34, F_44 respectively.

- dustkapmean.dat ::

  This file will only be written with the =-t= switch. It contains 3
  columns: (1) T [K], (2) \kappa_Planck, (3) \kappa_Ross, both in cm^2
  per gram of /dust/. Note that dust evaporation is not considered,
  and that a wide wavelengths coverage is needed for good results.

** Inspecting the computed optical properties

To try out =optool= you could use one of these commands

: make test             # for a simple size-integrated opacity computation
:     ... or ...
: make testdiv          # for opacities as a fuction of grain size

The commands will run =optool= with the standard DIANA material
properties, and then use the python script =optool.py= to plot the
computed opacities.  You will get two plots
- a plot showing the opacities \kappa_abs, \kappa_sca, and \kappa_ext
  as a function of wavelength, along with the asymmetry parameter /g/.
  Note that the red /g/ curve does not have its own scale, imagine the
  /y/ axis going from 0 to 1 for /g/.
- a plot showing the scattering matrix elements as a function of
  scattering angle, and with sliders to go through grain sizes and
  wavelengths.  The /y/ axis of the plot is actually log_10(|F_ij|), so
  the downward peaks are actually places where the matrix element goes
  through zero.

#+CAPTION: Screenshot of the plots created by running =ipython -i optool.py=. Note that we plot the logarithm of the absolute value of the scattering matrix, in order to deal with range and sign issues.
#+ATTR_LATEX: :width 15cm :options angle=0
[[./misc/inspect.png]]




** Acknowledgments
- [[http://michielmin.nl/][Michiel Min]] for the [[https://dianaproject.wp.st-andrews.ac.uk/data-results-downloads/fortran-package/][DIANA OpacityTool]] and all the work that went
  into it. =optool= is a direct derivative of that tool.
- [[https://www.researchgate.net/profile/Charlene_Lefevre][Charléne Lefévre]] for [[https://github.com/charlenelefevre/SIGMA][SIGMA]]. =optool= uses the generalized Bruggeman
  solver and a few other bits from SIGMA's code base.
- [[http://www.ita.uni-heidelberg.de/~dullemond/index.shtml?lang=en][Kees Dullemond]] for his python plotting routine =viewarr= ([[https://github.com/dullemond/interactive_plot][available
  on github]]), and code for computing Planck and Rosseland means
  opacities.
- [[https://www.mpia.de/person/32666/1415887][Jeroen Bouwman]] for pointers to refractive index data.

** Appendix

*** How to ingest another material
Additional data tables can be compiled into the code.  Here is how to
do this:

1. Give your lnk file a name exactly like =pyr-mg70-Dorschner1995.lnk=, where
   =pyr-mg70= is the key to access the material and =Dorschner1995= is
   the reference.
2. Put this file into the =lnk_data= directory.
3. Edit =lnk_data/lnk-help.txt=, so that =optool -c ?= will list the
   new material.
4. Run =make ingest= to update =ref_ind.f90=, now including your new
   material.
5. Recompile and install the code.

#+LATEX: \clearpage

*** Scattering phase function normalization
:PROPERTIES:
:CUSTOM_ID: normalization
:END:
A number of different normalizations for the scattering matrix are
being used in the literature and in computational tools. The
differences are significant, and it is important to be aware of the
choice. For =optool= we are using a convention in which the average
over all directions of the 1-1 element of the scattering matrix equals
unity, i.e.

\begin{equation}
\label{eq:1}
\oint_{(4\pi)} F_{11}(\lambda,\Theta) d\Omega = 4\pi
\end{equation}

See [[https://ui.adsabs.harvard.edu/abs/2004nsm..rept....1H][Hovenier (2004)]] for a discussion of this normalization.  =optool=
can also produce output for [[http://www.ita.uni-heidelberg.de/~dullemond/software/radmc-3d/][RADMC-3D]] which uses a different
normalization, namely

\begin{equation}
\label{eq:2}
\oint_{(4\pi)} Z_{11}(\lambda,\Theta) d\Omega = \kappa_{\rm sca}(\lambda)
\end{equation}

For details, see the [[http://www.ita.uni-heidelberg.de/~dullemond/software/radmc-3d/guide.html][RADMC-3D manual]].


** Bibliography
- Dorschner,J. et al. 1995, A&A 300, 503
- Henning, Th. and Stognienko, R. 1996, A&A 311,291
- Hovenier, J, 2004, [[https://ui.adsabs.harvard.edu/abs/2004nsm..rept....1H][Report available on ADS]].
- Jäger,C. et al. 1998, A&A 339, 904
- Koike,C. et al. 1995, Icarus 114, 203
- Lefèvre,C.; Min,M. et al. 2020, A&A (submitted)
- Min,M. et al, 2005, A&A, 432, 909
- Min,M. et al. 2016, A&A, 585, 13
- Toon,O. & Ackerman,T. 1981, Applied Optics 20, 3657
- Woitke,P.; Min,M. et al. 2016, A&A 586, 103
- Preibisch,Th. et al. 1993, A&A 279, 577
- Steyer,T. 1974, PhD Thesis, The University of Arizona
- Warren,S. and Brandt,R. 2008, JGRD,113, D14220
- Zubko,V. et al. 1996, MNRAS 282,1321


